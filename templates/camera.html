{% extends "base.html" %}

{% block title %}Camera{% endblock %}

{% block content %}
<div class="page-header mb-4">
  <h2 class="mb-1">Camera Attendance</h2>
  <div class="text-secondary">Select a class and point the camera at students to mark attendance.</div>
</div>

<div class="row g-4">
  <div class="col-md-8">
    <div class="card-surface p-2">
      <img src="{{ url_for('video_feed', class_name=class_name) }}" alt="Camera Feed" class="img-fluid rounded-3">
    </div>
  </div>

  <div class="col-md-4">
    <div class="card-surface p-3 mb-3">
      <h5><i class="bi bi-gear"></i> Controls</h5>
      <form method="GET" action="{{ url_for('camera_page') }}" class="d-flex gap-2">
        <select name="class_name" class="form-select">
          {% for c in classes %}
          <option value="{{ c['class_name'] }}" {% if c['class_name'] == class_name %}selected{% endif %}>
            {{ c['class_name'] }}
          </option>
          {% endfor %}
        </select>
        <button class="btn btn-brand">Set</button>
      </form>
    </div>

    <div class="card-surface p-3">
      <h5><i class="bi bi-arrow-clockwise"></i> Reset Attendance</h5>
      <p class="text-secondary small">
        If needed, you can clear all attendance records for the selected class and date.
      </p>
      <form method="POST" action="{{ url_for('reset_attendance') }}" onsubmit="return confirm('Are you sure you want to reset attendance for this day?');">
        <input type="hidden" name="class_name" value="{{ class_name }}">
        <div class="mb-2">
          <label class="form-label">Date to Reset</label>
          <input type="date" class="form-control" name="date" value="{{ now }}">
        </div>
        <button class="btn btn-outline-danger w-100">Reset Now</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
